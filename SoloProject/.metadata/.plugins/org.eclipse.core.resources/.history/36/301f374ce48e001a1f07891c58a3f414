<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<link type="text/css" rel="stylesheet" href="background.css"></link>
	<title>Insert title here</title>
</head>
<body>
	<div>
		<center>
			<div><h2 id="current_time" ></h2></div>
			<div><h1 id="current_weather"></h1></div>
			<div id="current_temp"></div>
		</center>
	</div>
	<div class="forecast_layer_outter">
		<div class="forecast_layer_inner">
			<div class="forecast_contents">
				<div class="box">
					<div id="box1_weather">날씨</div>
					<div id="box1_weather_icon"></div>
					<div id="box1_temp">온도</div>
					<div id="box1_time">시간</div>
				</div>
				<div class="box">
					<div id="box2_weather">날씨</div>
					<div id="box2_weather_icon"></div>
					<div id="box2_temp">온도</div>
					<div id="box2_time">시간</div>
				</div>
				<div class="box">
					<div id="box3_weather">날씨</div>
					<div id="box3_weather_icon"></div>
					<div id="box3_temp">온도</div>
					<div id="box3_time">시간</div>
				</div>
				<div class="box">
					<div id="box4_weather">날씨</div>
					<div id="box4_weather_icon"></div>
					<div id="box4_temp">온도</div>
					<div id="box4_time">시간</div>
				</div>
				<div class="box">
					<div id="box5_weather">날씨</div>
					<div id="box5_weather_icon"></div>
					<div id="box5_temp">온도</div>
					<div id="box5_time">시간</div>
				</div>
				<div class="box">
					<div id="box6_weather">날씨</div>
					<div id="box6_weather_icon"></div>
					<div id="box6_temp">온도</div>
					<div id="box6_time">시간</div>
				</div>
			</div>
		</div>
	</div>
	
   		
   	<!----script 부분---->
	<script>
		function parseWeather(){
			forecast_loadJSON(function(response){
				var jsonData = JSON.parse(response);
				var date = new Date(jsonData["list"][0]["dt_txt"]);
				date.setHours(date.getHours()+9)
				for(i = 0; i<7 ;i++){	
					var imgURL = "http://openweathermap.org/img/w/" + jsonData.weather[0].icon + ".png";
					$("#box"+i+"_weather").text(jsonData["list"][i]["weather"][0]["main"]);
					$("#box"+i+"_weather_icon").attr("src", imgURL);
					$("#box"+i+"_temp").text(Math.floor((jsonData["list"][i]["main"]["temp"] - 273.15))+"°C");
					
					$("#box"+i+"_time").text(date.getDate()+"일 "+date.getHours()+"시");
					date.setHours(date.getHours()+3);
				}
				
			});
			
			weather_loadJSON(function(response){
				var jsonData = JSON.parse(response);
				var date = new Date();
				$("#current_time").text(date.getMonth()+"월 "+date.getDate()+"일 "+date.getHours()+"시");
				$("#current_temp").text((jsonData["main"]["temp"] - 273.15)+"°C");
				$("#current_weather").text(jsonData["weather"][0]["main"]);
			});
		}
		
		
		function forecast_loadJSON(callback){
			var apiURL ="http://api.openweathermap.org/data/2.5/forecast?q=Daegu,KR&cnt=7&appid=dc8d5f394054b66bd905f0d24fc95a3d " 			
			var request = new XMLHttpRequest();
			request.overrideMimeType("application/json");
			request.open('GET',apiURL, true);
			
			request.onreadystatechange = function(){
				if(request.readyState == 4 && request.status =="200"){
					callback(request.responseText);
				}
			};
			request.send(null);
		}
		
		
		function weather_loadJSON(callback){
			var apiURL ="http://api.openweathermap.org/data/2.5/weather?q=Daegu,KR&appid=dc8d5f394054b66bd905f0d24fc95a3d " 	
			var request = new XMLHttpRequest();
			request.overrideMimeType("application/json");
			request.open('GET',apiURL, true);
			
			request.onreadystatechange = function(){
				if(request.readyState == 4 && request.status =="200"){
					callback(request.responseText);
				}
			};
			request.send(null);
		}
		window.onload = function(){
			parseWeather();
		}
			
	</script>
      
</body>
</html>
